# 11. 단위 테스트 안티 패턴

## 비공개 메서드의 단위 테스트

- 비공개 메서드를 직접 테스트 하는 대신, 포괄적인 식별 가능한 동작으로서 간접적으로 테스트
- 비공개 메서드가 클래스의 식별 가능한 동작일 경우 ( ex. ORM ) 를 테스트 하는 것 나쁜 아이디어는 아니다.
- 하지만, 비공개 메서드의 구현 세부 사항를 테스트 하는 경우 테스트가 깨직기 쉽다.

## 비공개 상태 노출

- 단위 테스트를 목적으로 비공개 상태를 노출해서는 안된다.

## 테스트로 유출된 도메인 지식

- 테스트 모드가 구현 세부사항과 동일 혹은 유사하게 작성된 경우 테스트가 깨지기 쉽다.
- 블랙박스 관점에서 구현 코드를 검증한다.

## 코드 오염

- 테스트에만 필요한 기능 혹은 제품 상태를 추가하는 행위를 금지한다.
- 테스트 코드와 제품 코드와 일관성이 필요하다.

## 구체 클래스를 목으로 처리

- 테스트 대상 클래스의 일부만 ( 비관리 의존성과 동신하는 책임) 을 Mock 으로 대체하는 행위는 단일 책임 원칙을 위반하는 행위이다.

> 하지만, 클래스 내부의 의존성을 분리할 수 없는 경우, Mock 으로 처리해도 되지 않을까?
>
{style="warning"}

## 시간 처리

- 엠비언드 컨텍스트(Ambient context)에서 정적 메소드로 시간을 참조
    - 이런 경우 제품 코드의 복잡성을 높이고, 테스트가 어려워 진다.
- 명시적 의존성으로 일반 값으로 시간 주입